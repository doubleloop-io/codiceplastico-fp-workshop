# Text-based RPG

## Refactoring TODO
- remove mutable var executing in Game
    - generate a new state (executing) for each loop iteration
    - tipically the new state is generated by the evaluation of old state
    - from class field to local var
    - inline local
    - Boolean return type is a lie, the function produce two value: unit and bool
- remove while loop
    - recursion, yeah!
- remove multable var in Postion case class
    - same as before, use current state (position) to generate the new state (position)
    - from Unit to Somthing impact caller, temporarily use mutable state (var)
    - go back to the call stack until you have a single mutabel state
- remove mutable var world in Game
    - pass the world as parameter
    - from class field to local var
    - inline local
- use lens to manipulate (get, set, modify, â€¦) immutable objects
    - copy is great but it's not scalable with nested structure
    - the code leak the structure of your model (fragile to change)
    - they compose!
- enforce correctness through types
    - remove primitive
    - don't reuse similar types for different needs
    - making illegal states unrepresentable
- remove throws
    - from exception to effect
    - transform a "crazy goto" into a value
- split command parsing from execution
    - separate "program" construction from evaluation
- split final action generation from execution
    - more, separate "program" construction from evaluation
- handle side effect with IO monad
    - I/O operations are side-effect
    - lazy capture the I/O operation
    - execute "later" on specific request
    - "later" means in the main




- use the state monad to pass the game world through the funtions
    - remove world parameter from all functions
    - express state changes in a declarative way
    - compose logic with map and flatMap

## Features TODO
- every cell can be land or sea
- if the player ends up in the sea, he dies and the game ends
- a land can contains an enemy
- add the command 'fight', in response the player suffers damage for a constant value eg: -10
- produce a random damage value
- a land can contains potion that gives life to the player for a constant value of eg: 20